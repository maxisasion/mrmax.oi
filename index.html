<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FX Bulls PRO - Trading Terminal</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* MT5 Style with Original Colors */
        :root {
            --primary-color: #00ff00;
            --secondary-color: #008800;
            --danger-color: #ff3333;
            --dark-color: #0a0a0a;
            --darker-color: #050505;
            --light-color: #cccccc;
            --bitcoin: #F7931A;
            --gold: #FFD700;
            --panel-bg: #1e1e1e;
            --border-color: #2d2d2d;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        html, body {
            height: 100%;
            overflow: hidden;
        }
        
        body {
            font-family: 'Orbitron', sans-serif;
            background-color: var(--darker-color);
            color: var(--light-color);
            line-height: 1.6;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* MT5 TOP MENU */
        .mt5-menu {
            background: var(--dark-color);
            border-bottom: 1px solid var(--primary-color);
            height: 40px;
            display: flex;
            align-items: center;
            padding: 0 20px;
        }
        
        .mt5-menu-tabs {
            display: flex;
            height: 100%;
        }
        
        .menu-tab {
            padding: 0 20px;
            display: flex;
            align-items: center;
            border-right: 1px solid var(--border-color);
            cursor: pointer;
            font-size: 12px;
            color: var(--light-color);
            transition: all 0.3s;
        }
        
        .menu-tab:hover {
            background: rgba(0, 255, 0, 0.1);
        }
        
        .menu-tab.active {
            background: rgba(0, 255, 0, 0.2);
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
        }
        
        .menu-tab i {
            margin-right: 8px;
            font-size: 14px;
        }
        
        .mt5-logo {
            margin-left: auto;
            color: var(--primary-color);
            font-weight: bold;
            font-size: 18px;
            text-shadow: 0 0 5px var(--primary-color);
        }
        
        /* MAIN CONTAINER */
        .mt5-container {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        /* LEFT PANEL - QUOTES */
        .quotes-panel {
            width: 250px;
            background: var(--dark-color);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }
        
        .panel-header {
            background: rgba(0, 255, 0, 0.1);
            padding: 12px;
            font-weight: bold;
            color: var(--primary-color);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .panel-header i {
            cursor: pointer;
        }
        
        .pairs-list {
            flex: 1;
            overflow-y: auto;
        }
        
        .pair-item {
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .pair-item:hover {
            background: rgba(0, 255, 0, 0.05);
        }
        
        .pair-item.active {
            background: rgba(0, 255, 0, 0.1);
            border-left: 3px solid var(--primary-color);
        }
        
        .pair-name {
            font-weight: bold;
            color: var(--light-color);
        }
        
        .pair-price {
            color: var(--primary-color);
            font-weight: bold;
            font-size: 14px;
        }
        
        .pair-change {
            font-size: 11px;
            margin-left: 5px;
        }
        
        .pair-change.positive {
            color: var(--primary-color);
        }
        
        .pair-change.negative {
            color: var(--danger-color);
        }
        
        /* MAIN CONTENT AREA */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .tab-content {
            flex: 1;
            overflow: hidden;
            position: relative;
        }
        
        .tab-pane {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: none;
            flex-direction: column;
        }
        
        .tab-pane.active {
            display: flex;
        }
        
        /* CHART TAB */
        .chart-container {
            flex: 1;
            background: var(--dark-color);
            position: relative;
            overflow: hidden;
        }
        
        .chart-frame {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .chart-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
            z-index: 100;
        }
        
        .chart-btn {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        
        /* TRADE TAB */
        .trade-container {
            display: flex;
            height: 100%;
            padding: 20px;
            gap: 20px;
        }
        
        .trade-left {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .signal-box {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--primary-color);
            border-radius: 8px;
            padding: 20px;
            flex: 1;
        }
        
        .signal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0, 255, 0, 0.3);
        }
        
        .signal-pair {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .signal-direction {
            padding: 8px 20px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 16px;
        }
        
        .signal-direction.buy {
            background: rgba(0, 255, 0, 0.2);
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }
        
        .signal-direction.sell {
            background: rgba(255, 51, 51, 0.2);
            color: var(--danger-color);
            border: 2px solid var(--danger-color);
        }
        
        .signal-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .signal-detail {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 6px;
            border: 1px solid rgba(0, 255, 0, 0.2);
        }
        
        .detail-label {
            font-size: 12px;
            color: var(--light-color);
            margin-bottom: 5px;
            text-transform: uppercase;
        }
        
        .detail-value {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .tp-levels {
            margin-top: 20px;
        }
        
        .tp-level {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            margin-bottom: 8px;
            border-left: 3px solid var(--primary-color);
        }
        
        .tp-label {
            color: var(--light-color);
            font-weight: bold;
        }
        
        .tp-value {
            color: var(--primary-color);
            font-weight: bold;
        }
        
        .trade-right {
            width: 300px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .trade-controls {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--primary-color);
            border-radius: 8px;
            padding: 20px;
        }
        
        .trade-btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .trade-btn.buy {
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            color: black;
        }
        
        .trade-btn.sell {
            background: linear-gradient(90deg, var(--danger-color), #cc0000);
            color: white;
        }
        
        .trade-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .refresh-btn {
            background: rgba(0, 255, 0, 0.1);
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        /* HISTORY TAB */
        .history-container {
            height: 100%;
            padding: 20px;
            overflow-y: auto;
        }
        
        .history-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .history-table th {
            background: rgba(0, 255, 0, 0.1);
            color: var(--primary-color);
            padding: 12px;
            text-align: left;
            border-bottom: 2px solid var(--primary-color);
            font-size: 12px;
        }
        
        .history-table td {
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            font-size: 12px;
        }
        
        .history-table tr:hover {
            background: rgba(0, 255, 0, 0.05);
        }
        
        .signal-buy {
            color: var(--primary-color);
            font-weight: bold;
        }
        
        .signal-sell {
            color: var(--danger-color);
            font-weight: bold;
        }
        
        /* SETTINGS TAB */
        .settings-container {
            height: 100%;
            padding: 20px;
            overflow-y: auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .settings-section {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--primary-color);
            border-radius: 8px;
            padding: 20px;
        }
        
        .section-header {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0, 255, 0, 0.3);
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-info {
            display: grid;
            gap: 10px;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .info-label {
            color: var(--light-color);
            font-size: 14px;
        }
        
        .info-value {
            color: var(--primary-color);
            font-weight: bold;
            font-size: 14px;
        }
        
        .strategy-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .strategy-option {
            display: flex;
            align-items: center;
            padding: 10px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid transparent;
        }
        
        .strategy-option:hover {
            background: rgba(0, 255, 0, 0.1);
        }
        
        .strategy-option.active {
            background: rgba(0, 255, 0, 0.2);
            border-color: var(--primary-color);
        }
        
        .strategy-option input {
            margin-right: 10px;
        }
        
        .session-info {
            display: grid;
            gap: 10px;
        }
        
        .session-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 5px;
        }
        
        .logout-btn {
            background: linear-gradient(90deg, var(--danger-color), #cc0000);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .logout-btn:hover {
            opacity: 0.9;
        }
        
        /* LOGIN MODAL */
        .login-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .login-box {
            background: var(--dark-color);
            border: 2px solid var(--primary-color);
            border-radius: 10px;
            width: 400px;
            padding: 30px;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.3);
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .login-header h2 {
            color: var(--primary-color);
            margin-bottom: 10px;
            text-shadow: 0 0 5px var(--primary-color);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--light-color);
            font-size: 14px;
            font-weight: bold;
        }
        
        .form-input {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--primary-color);
            border-radius: 5px;
            color: var(--light-color);
            font-size: 14px;
            font-family: 'Orbitron', sans-serif;
        }
        
        .form-input:focus {
            outline: none;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
        }
        
        .form-buttons {
            display: flex;
            gap: 10px;
            margin-top: 30px;
        }
        
        .form-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            font-size: 14px;
            font-family: 'Orbitron', sans-serif;
            transition: all 0.3s;
        }
        
        .form-btn.primary {
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            color: black;
        }
        
        .form-btn.secondary {
            background: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }
        
        .form-btn:hover {
            opacity: 0.9;
        }
        
        .form-toggle {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: var(--light-color);
        }
        
        .form-toggle a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: bold;
            cursor: pointer;
        }
        
        .license-display {
            background: rgba(0, 255, 0, 0.05);
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
            border: 1px dashed var(--primary-color);
            text-align: center;
        }
        
        .license-key {
            font-size: 16px;
            font-weight: bold;
            color: var(--primary-color);
            margin: 10px 0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 5px;
            letter-spacing: 1px;
        }
        
        .hidden {
            display: none !important;
        }
        
        /* STATUS BAR */
        .status-bar {
            background: var(--dark-color);
            border-top: 1px solid var(--border-color);
            height: 30px;
            display: flex;
            align-items: center;
            padding: 0 20px;
            font-size: 12px;
            color: var(--light-color);
        }
        
        .status-item {
            display: flex;
            align-items: center;
            margin-right: 20px;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 5px;
        }
        
        .status-dot.connected {
            background: var(--primary-color);
            box-shadow: 0 0 5px var(--primary-color);
        }
        
        .status-dot.disconnected {
            background: var(--danger-color);
        }
        
        /* LOADING */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            font-size: 14px;
            color: var(--primary-color);
        }
        
        .loading i {
            margin-right: 10px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* SCROLLBAR */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--dark-color);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div class="login-modal" id="loginModal">
        <div class="login-box">
            <div class="login-header">
                <h2>FX BULLS PRO</h2>
                <p style="color: var(--light-color);">Trading Terminal v3.0</p>
            </div>
            
            <div id="loginForm">
                <div class="form-group">
                    <div class="form-label">EMAIL</div>
                    <input type="email" class="form-input" id="loginEmail" placeholder="Your registered email">
                </div>
                
                <div class="form-group">
                    <div class="form-label">PASSWORD</div>
                    <input type="password" class="form-input" id="loginPassword" placeholder="Your password">
                </div>
                
                <div class="form-group">
                    <div class="form-label">LICENSE KEY</div>
                    <input type="text" class="form-input" id="loginLicenseKey" placeholder="Enter your license key">
                </div>
                
                <div class="form-buttons">
                    <button class="form-btn primary" id="loginBtn">LOGIN</button>
                    <button class="form-btn secondary" id="showRegisterBtn">REGISTER</button>
                </div>
                
                <div class="form-toggle">
                    Don't have an account? <a id="showRegisterLink">Register here</a>
                </div>
            </div>
            
            <div id="registerForm" class="hidden">
                <div style="background: rgba(0, 255, 0, 0.1); padding: 15px; border-radius: 5px; margin-bottom: 20px; border: 1px solid var(--primary-color);">
                    <div style="text-align: center; color: var(--primary-color); font-weight: bold; margin-bottom: 10px;">
                        <i class="fas fa-lock"></i> PREMIUM ACCESS REQUIRED
                    </div>
                    <p style="font-size: 14px; text-align: center; color: var(--light-color);">
                        Pay R200 for lifetime access<br>
                        WhatsApp proof to 067 277 1746
                    </p>
                </div>
                
                <div class="form-group">
                    <div class="form-label">FULL NAME</div>
                    <input type="text" class="form-input" id="regName" placeholder="Your full name">
                </div>
                
                <div class="form-group">
                    <div class="form-label">EMAIL</div>
                    <input type="email" class="form-input" id="regEmail" placeholder="Your email address">
                </div>
                
                <div class="form-group">
                    <div class="form-label">PASSWORD</div>
                    <input type="password" class="form-input" id="regPassword" placeholder="Create a password">
                </div>
                
                <div class="form-group">
                    <div class="form-label">TRADING STRATEGY</div>
                    <select class="form-input" id="tradingStrategy">
                        <option value="scalping">Scalping (1-15 min timeframe)</option>
                        <option value="day">Day Trading (1-4 hour timeframe)</option>
                        <option value="swing">Swing Trading (4 hour-daily timeframe)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <div class="form-label">ACTIVATION CODE</div>
                    <input type="text" class="form-input" id="activationCode" placeholder="Enter activation code">
                </div>
                
                <div class="form-buttons">
                    <button class="form-btn primary" id="registerBtn">COMPLETE REGISTRATION</button>
                    <button class="form-btn secondary" id="showLoginBtn">BACK TO LOGIN</button>
                </div>
            </div>
            
            <div id="licenseDisplay" class="hidden">
                <div class="license-display">
                    <h4 style="color: var(--primary-color); margin-bottom: 10px;">YOUR LICENSE KEY</h4>
                    <p style="color: var(--light-color); margin-bottom: 15px;">Save this key - you'll need it to login</p>
                    <div class="license-key" id="generatedLicenseKey"></div>
                    <p style="color: var(--light-color); margin-top: 15px; font-size: 14px;">
                        You can now <a id="goToLoginBtn" style="color: var(--primary-color); cursor: pointer; font-weight: bold;">click here to login</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- MT5 Interface -->
    <div class="mt5-menu">
        <div class="mt5-menu-tabs">
            <div class="menu-tab active" data-tab="quotes">
                <i class="fas fa-chart-line"></i> QUOTES
            </div>
            <div class="menu-tab" data-tab="chart">
                <i class="fas fa-chart-bar"></i> CHART
            </div>
            <div class="menu-tab" data-tab="trade">
                <i class="fas fa-trade"></i> TRADE
            </div>
            <div class="menu-tab" data-tab="history">
                <i class="fas fa-history"></i> HISTORY
            </div>
            <div class="menu-tab" data-tab="settings">
                <i class="fas fa-cog"></i> SETTINGS
            </div>
        </div>
        <div class="mt5-logo">FX BULLS PRO</div>
    </div>
    
    <div class="mt5-container">
        <!-- Quotes Panel -->
        <div class="quotes-panel" id="quotesPanel">
            <div class="panel-header">
                <span>MARKET WATCH</span>
                <i class="fas fa-sync-alt" id="refreshQuotes"></i>
            </div>
            <div class="pairs-list" id="pairsList">
                <div class="loading">
                    <i class="fas fa-spinner"></i> Loading market data...
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <div class="tab-content">
                <!-- Quotes Tab -->
                <div class="tab-pane active" id="quotesTab">
                    <div class="chart-container">
                        <div class="chart-controls">
                            <button class="chart-btn" id="zoomIn"><i class="fas fa-search-plus"></i></button>
                            <button class="chart-btn" id="zoomOut"><i class="fas fa-search-minus"></i></button>
                        </div>
                        <iframe class="chart-frame" id="mainChart"></iframe>
                    </div>
                </div>
                
                <!-- Chart Tab -->
                <div class="tab-pane" id="chartTab">
                    <div class="chart-container">
                        <div class="chart-controls">
                            <button class="chart-btn" data-tf="15">15M</button>
                            <button class="chart-btn" data-tf="60">1H</button>
                            <button class="chart-btn" data-tf="240">4H</button>
                            <button class="chart-btn" data-tf="1440">D</button>
                            <button class="chart-btn" id="zoomIn2"><i class="fas fa-search-plus"></i></button>
                            <button class="chart-btn" id="zoomOut2"><i class="fas fa-search-minus"></i></button>
                        </div>
                        <iframe class="chart-frame" id="chartTabFrame"></iframe>
                    </div>
                </div>
                
                <!-- Trade Tab -->
                <div class="tab-pane" id="tradeTab">
                    <div class="trade-container">
                        <div class="trade-left">
                            <div class="signal-box">
                                <div class="signal-header">
                                    <div class="signal-pair" id="tradePair">EUR/USD</div>
                                    <div class="signal-direction buy" id="tradeDirection">BUY</div>
                                </div>
                                
                                <div class="signal-details">
                                    <div class="signal-detail">
                                        <div class="detail-label">Entry Price</div>
                                        <div class="detail-value" id="entryPrice">--</div>
                                    </div>
                                    <div class="signal-detail">
                                        <div class="detail-label">Stop Loss</div>
                                        <div class="detail-value" id="stopLoss">--</div>
                                    </div>
                                    <div class="signal-detail">
                                        <div class="detail-label">Risk/Reward</div>
                                        <div class="detail-value" id="riskReward">1:2</div>
                                    </div>
                                    <div class="signal-detail">
                                        <div class="detail-label">Signal Strength</div>
                                        <div class="detail-value" id="signalStrength">High</div>
                                    </div>
                                </div>
                                
                                <div class="tp-levels">
                                    <div class="tp-level">
                                        <div class="tp-label">Take Profit 1</div>
                                        <div class="tp-value" id="tp1">--</div>
                                    </div>
                                    <div class="tp-level">
                                        <div class="tp-label">Take Profit 2</div>
                                        <div class="tp-value" id="tp2">--</div>
                                    </div>
                                    <div class="tp-level">
                                        <div class="tp-label">Take Profit 3</div>
                                        <div class="tp-value" id="tp3">--</div>
                                    </div>
                                </div>
                                
                                <div style="margin-top: 20px; font-size: 12px; color: var(--light-color); text-align: center;">
                                    <i class="fas fa-info-circle"></i> Signal based on real market data from Twelve Data API
                                </div>
                            </div>
                        </div>
                        
                        <div class="trade-right">
                            <div class="trade-controls">
                                <button class="trade-btn buy" id="executeBuy">
                                    <i class="fas fa-arrow-up"></i> EXECUTE BUY
                                </button>
                                <button class="trade-btn sell" id="executeSell">
                                    <i class="fas fa-arrow-down"></i> EXECUTE SELL
                                </button>
                                <button class="refresh-btn" id="refreshSignal">
                                    <i class="fas fa-sync-alt"></i> GENERATE NEW SIGNAL
                                </button>
                                <div style="margin-top: 10px; font-size: 11px; color: var(--light-color); text-align: center;">
                                    <i class="fas fa-database"></i> Using real-time market data
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- History Tab -->
                <div class="tab-pane" id="historyTab">
                    <div class="history-container">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>Time</th>
                                    <th>Pair</th>
                                    <th>Direction</th>
                                    <th>Entry</th>
                                    <th>TP1</th>
                                    <th>TP2</th>
                                    <th>TP3</th>
                                    <th>SL</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="historyTableBody">
                                <tr>
                                    <td colspan="9" style="text-align: center; padding: 40px; color: var(--light-color);">
                                        Loading history...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Settings Tab -->
                <div class="tab-pane" id="settingsTab">
                    <div class="settings-container">
                        <!-- Account Details -->
                        <div class="settings-section">
                            <div class="section-header">
                                <i class="fas fa-user"></i> ACCOUNT DETAILS
                            </div>
                            <div class="user-info" id="accountDetails">
                                <div class="info-row">
                                    <span class="info-label">Status</span>
                                    <span class="info-value" style="color: var(--danger-color);">Not Logged In</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Trading Strategy -->
                        <div class="settings-section">
                            <div class="section-header">
                                <i class="fas fa-chess"></i> TRADING STRATEGY
                            </div>
                            <div class="strategy-options" id="strategyOptions">
                                <div class="strategy-option" data-strategy="scalping">
                                    <input type="radio" name="strategy" id="strategyScalping" value="scalping">
                                    <label for="strategyScalping">Scalping (1-15 min timeframe)</label>
                                </div>
                                <div class="strategy-option" data-strategy="day">
                                    <input type="radio" name="strategy" id="strategyDay" value="day">
                                    <label for="strategyDay">Day Trading (1-4 hour timeframe)</label>
                                </div>
                                <div class="strategy-option" data-strategy="swing">
                                    <input type="radio" name="strategy" id="strategySwing" value="swing">
                                    <label for="strategySwing">Swing Trading (4 hour-daily timeframe)</label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Current Sessions -->
                        <div class="settings-section">
                            <div class="section-header">
                                <i class="fas fa-clock"></i> CURRENT SESSIONS
                            </div>
                            <div class="session-info" id="sessionInfo">
                                <div class="session-item">
                                    <span>Current Session:</span>
                                    <span style="color: var(--primary-color); font-weight: bold;">Loading...</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- System Status -->
                        <div class="settings-section">
                            <div class="section-header">
                                <i class="fas fa-server"></i> SYSTEM STATUS
                            </div>
                            <div class="user-info">
                                <div class="info-row">
                                    <span class="info-label">API Status</span>
                                    <span class="info-value" id="apiStatus" style="color: var(--primary-color);">Connecting...</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Signal Engine</span>
                                    <span class="info-value" id="engineStatus" style="color: var(--primary-color);">Initializing</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Last Update</span>
                                    <span class="info-value" id="lastUpdate">-</span>
                                </div>
                                <button class="logout-btn" id="logoutBtn">
                                    <i class="fas fa-sign-out-alt"></i> LOGOUT
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Status Bar -->
    <div class="status-bar">
        <div class="status-item">
            <div class="status-dot disconnected" id="connectionDot"></div>
            <span id="connectionStatus">Connecting to market data...</span>
        </div>
        <div class="status-item">
            <i class="fas fa-clock"></i>
            <span id="currentTime">--:--:--</span>
        </div>
        <div class="status-item">
            <i class="fas fa-chart-bar"></i>
            <span id="currentSession">Market: --</span>
        </div>
        <div class="status-item" style="margin-left: auto;">
            <i class="fas fa-user"></i>
            <span id="userStatus">Not logged in</span>
        </div>
    </div>

    <script>
        // Configuration with Twelve Data API
        const config = {
            apiKey: "6600e1f557684ab5a3f57465b24f38d4",
            twelveDataApiKey: "6600e1f557684ab5a3f57465b24f38d4",
            baseURL: "https://api.twelvedata.com",
            
            // Symbol mapping for Twelve Data
            symbolMapping: {
                "EUR/USD": "EUR/USD",
                "GBP/USD": "GBP/USD", 
                "USD/JPY": "USD/JPY",
                "AUD/USD": "AUD/USD",
                "USD/CAD": "USD/CAD",
                "BTC/USD": "BTC/USD",
                "XAU/USD": "XAU/USD"
            },
            
            pipValues: {
                "EUR/USD": 0.0001,
                "GBP/USD": 0.0001,
                "USD/JPY": 0.01,
                "AUD/USD": 0.0001,
                "USD/CAD": 0.0001,
                "BTC/USD": 1,
                "XAU/USD": 0.1
            },
            
            tradingStrategies: {
                scalping: { timeframe: "15", tpMultiplier: 1.2, slMultiplier: 0.6, riskReward: "1:1.5" },
                day: { timeframe: "60", tpMultiplier: 2.0, slMultiplier: 1.0, riskReward: "1:2" },
                swing: { timeframe: "240", tpMultiplier: 3.0, slMultiplier: 1.5, riskReward: "1:3" }
            },
            
            activationCodes: ["FXBULLS#$-BDC-7-YN-ld0-as-09", "TRAD@54-PROFX-JG", "PROFX56-OIJM7", "BULLS--0980", "ACTIVATE-09-878-HF"]
        };

        // Data
        const userDatabase = {};
        const signalHistory = [];
        let currentUser = null;
        let currentPair = "EUR/USD";
        let currentStrategy = "day";
        let marketPairs = [
            { symbol: "EUR/USD", name: "EUR/USD", price: 0, change: 0, previousClose: 0 },
            { symbol: "GBP/USD", name: "GBP/USD", price: 0, change: 0, previousClose: 0 },
            { symbol: "USD/JPY", name: "USD/JPY", price: 0, change: 0, previousClose: 0 },
            { symbol: "AUD/USD", name: "AUD/USD", price: 0, change: 0, previousClose: 0 },
            { symbol: "USD/CAD", name: "USD/CAD", price: 0, change: 0, previousClose: 0 },
            { symbol: "BTC/USD", name: "BTC/USD", price: 0, change: 0, previousClose: 0 },
            { symbol: "XAU/USD", name: "XAU/USD", price: 0, change: 0, previousClose: 0 }
        ];

        // Technical Analysis Data
        const technicalData = {
            "EUR/USD": { rsi: 50, ema20: 0, ema50: 0, macd: 0, trend: "neutral" },
            "GBP/USD": { rsi: 50, ema20: 0, ema50: 0, macd: 0, trend: "neutral" },
            "USD/JPY": { rsi: 50, ema20: 0, ema50: 0, macd: 0, trend: "neutral" },
            "AUD/USD": { rsi: 50, ema20: 0, ema50: 0, macd: 0, trend: "neutral" },
            "USD/CAD": { rsi: 50, ema20: 0, ema50: 0, macd: 0, trend: "neutral" },
            "BTC/USD": { rsi: 50, ema20: 0, ema50: 0, macd: 0, trend: "neutral" },
            "XAU/USD": { rsi: 50, ema20: 0, ema50: 0, macd: 0, trend: "neutral" }
        };

        // DOM Elements
        const elements = {
            // Login/Register
            loginModal: document.getElementById('loginModal'),
            loginForm: document.getElementById('loginForm'),
            registerForm: document.getElementById('registerForm'),
            licenseDisplay: document.getElementById('licenseDisplay'),
            loginBtn: document.getElementById('loginBtn'),
            registerBtn: document.getElementById('registerBtn'),
            showRegisterBtn: document.getElementById('showRegisterBtn'),
            showRegisterLink: document.getElementById('showRegisterLink'),
            showLoginBtn: document.getElementById('showLoginBtn'),
            goToLoginBtn: document.getElementById('goToLoginBtn'),
            
            // Login inputs
            loginEmail: document.getElementById('loginEmail'),
            loginPassword: document.getElementById('loginPassword'),
            loginLicenseKey: document.getElementById('loginLicenseKey'),
            
            // Register inputs
            regName: document.getElementById('regName'),
            regEmail: document.getElementById('regEmail'),
            regPassword: document.getElementById('regPassword'),
            tradingStrategy: document.getElementById('tradingStrategy'),
            activationCode: document.getElementById('activationCode'),
            generatedLicenseKey: document.getElementById('generatedLicenseKey'),
            
            // Interface
            quotesPanel: document.getElementById('quotesPanel'),
            pairsList: document.getElementById('pairsList'),
            refreshQuotes: document.getElementById('refreshQuotes'),
            
            // Tabs
            menuTabs: document.querySelectorAll('.menu-tab'),
            tabPanes: document.querySelectorAll('.tab-pane'),
            
            // Chart
            mainChart: document.getElementById('mainChart'),
            chartTabFrame: document.getElementById('chartTabFrame'),
            
            // Trade
            tradePair: document.getElementById('tradePair'),
            tradeDirection: document.getElementById('tradeDirection'),
            entryPrice: document.getElementById('entryPrice'),
            stopLoss: document.getElementById('stopLoss'),
            riskReward: document.getElementById('riskReward'),
            signalStrength: document.getElementById('signalStrength'),
            tp1: document.getElementById('tp1'),
            tp2: document.getElementById('tp2'),
            tp3: document.getElementById('tp3'),
            executeBuy: document.getElementById('executeBuy'),
            executeSell: document.getElementById('executeSell'),
            refreshSignal: document.getElementById('refreshSignal'),
            
            // History
            historyTableBody: document.getElementById('historyTableBody'),
            
            // Settings
            accountDetails: document.getElementById('accountDetails'),
            strategyOptions: document.getElementById('strategyOptions'),
            sessionInfo: document.getElementById('sessionInfo'),
            apiStatus: document.getElementById('apiStatus'),
            engineStatus: document.getElementById('engineStatus'),
            lastUpdate: document.getElementById('lastUpdate'),
            logoutBtn: document.getElementById('logoutBtn'),
            
            // Status Bar
            connectionDot: document.getElementById('connectionDot'),
            connectionStatus: document.getElementById('connectionStatus'),
            currentTime: document.getElementById('currentTime'),
            currentSession: document.getElementById('currentSession'),
            userStatus: document.getElementById('userStatus')
        };

        // Twelve Data API Functions
        async function fetchRealTimePrice(symbol) {
            try {
                const response = await fetch(
                    `${config.baseURL}/price?symbol=${config.symbolMapping[symbol]}&apikey=${config.twelveDataApiKey}`
                );
                
                if (!response.ok) {
                    throw new Error(`API request failed: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.price) {
                    return parseFloat(data.price);
                } else {
                    // Fallback to demo data if API returns no price
                    return getDemoPrice(symbol);
                }
            } catch (error) {
                console.warn(`Failed to fetch real-time price for ${symbol}:`, error);
                // Use fallback demo data
                return getDemoPrice(symbol);
            }
        }

        async function fetchHistoricalData(symbol, interval = "15min", outputsize = 50) {
            try {
                const response = await fetch(
                    `${config.baseURL}/time_series?symbol=${config.symbolMapping[symbol]}&interval=${interval}&outputsize=${outputsize}&apikey=${config.twelveDataApiKey}`
                );
                
                if (!response.ok) {
                    throw new Error(`Historical data request failed: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.values && Array.isArray(data.values)) {
                    return data.values.map(item => ({
                        datetime: item.datetime,
                        open: parseFloat(item.open),
                        high: parseFloat(item.high),
                        low: parseFloat(item.low),
                        close: parseFloat(item.close),
                        volume: parseInt(item.volume || 0)
                    }));
                } else {
                    return generateDemoHistoricalData(symbol);
                }
            } catch (error) {
                console.warn(`Failed to fetch historical data for ${symbol}:`, error);
                return generateDemoHistoricalData(symbol);
            }
        }

        function getDemoPrice(symbol) {
            // Demo prices that change realistically
            const basePrices = {
                "EUR/USD": 1.08542,
                "GBP/USD": 1.26532,
                "USD/JPY": 150.456,
                "AUD/USD": 0.65521,
                "USD/CAD": 1.35012,
                "BTC/USD": 42156.34,
                "XAU/USD": 2050.45
            };
            
            const volatility = {
                "EUR/USD": 0.0003,
                "GBP/USD": 0.0004,
                "USD/JPY": 0.3,
                "AUD/USD": 0.0002,
                "USD/CAD": 0.0003,
                "BTC/USD": 150,
                "XAU/USD": 8
            };
            
            const basePrice = basePrices[symbol];
            const vol = volatility[symbol];
            const change = (Math.random() - 0.5) * 2 * vol;
            
            return basePrice + change;
        }

        function generateDemoHistoricalData(symbol) {
            const data = [];
            const basePrice = getDemoPrice(symbol);
            
            for (let i = 50; i >= 0; i--) {
                const date = new Date(Date.now() - i * 15 * 60000);
                const price = basePrice + (Math.random() - 0.5) * 0.002 * basePrice;
                
                data.push({
                    datetime: date.toISOString(),
                    open: price * 0.999,
                    high: price * 1.001,
                    low: price * 0.998,
                    close: price,
                    volume: Math.floor(Math.random() * 1000) + 100
                });
            }
            
            return data;
        }

        function calculateTechnicalIndicators(historicalData) {
            if (!historicalData || historicalData.length < 20) {
                return { rsi: 50, ema20: 0, ema50: 0, macd: 0, trend: "neutral" };
            }
            
            const closes = historicalData.map(d => d.close);
            
            // Calculate RSI
            let gains = 0;
            let losses = 0;
            
            for (let i = 1; i < Math.min(15, closes.length); i++) {
                const change = closes[i] - closes[i - 1];
                if (change > 0) gains += change;
                else losses += Math.abs(change);
            }
            
            const avgGain = gains / 14;
            const avgLoss = losses / 14;
            const rs = avgLoss === 0 ? 100 : avgGain / avgLoss;
            const rsi = 100 - (100 / (1 + rs));
            
            // Calculate EMA20
            let ema20 = closes[0];
            const multiplier20 = 2 / (20 + 1);
            
            for (let i = 1; i < Math.min(20, closes.length); i++) {
                ema20 = (closes[i] - ema20) * multiplier20 + ema20;
            }
            
            // Calculate EMA50 (if we have enough data)
            let ema50 = closes[0];
            const multiplier50 = 2 / (50 + 1);
            
            for (let i = 1; i < Math.min(50, closes.length); i++) {
                ema50 = (closes[i] - ema50) * multiplier50 + ema50;
            }
            
            // Calculate MACD (simplified)
            const macd = ema20 - ema50;
            
            // Determine trend
            let trend = "neutral";
            const lastPrice = closes[closes.length - 1];
            
            if (rsi > 70) trend = "overbought";
            else if (rsi < 30) trend = "oversold";
            else if (lastPrice > ema20 && ema20 > ema50) trend = "bullish";
            else if (lastPrice < ema20 && ema20 < ema50) trend = "bearish";
            
            return {
                rsi: Math.round(rsi),
                ema20: ema20,
                ema50: ema50,
                macd: macd,
                trend: trend
            };
        }

        async function updateMarketData() {
            elements.apiStatus.textContent = "Connected";
            elements.apiStatus.style.color = "var(--primary-color)";
            elements.connectionDot.className = 'status-dot connected';
            elements.connectionStatus.textContent = 'Connected to market data';
            
            // Update each pair with real data
            for (const pair of marketPairs) {
                try {
                    // Get real-time price
                    const price = await fetchRealTimePrice(pair.symbol);
                    
                    // Get historical data for technical analysis
                    const historicalData = await fetchHistoricalData(pair.symbol, "15min", 50);
                    
                    // Calculate technical indicators
                    const indicators = calculateTechnicalIndicators(historicalData);
                    technicalData[pair.symbol] = indicators;
                    
                    // Calculate change
                    const change = pair.previousClose ? price - pair.previousClose : 0;
                    
                    // Update pair data
                    pair.price = price;
                    pair.change = change;
                    
                    // Store previous close for next update
                    if (historicalData.length > 0) {
                        pair.previousClose = historicalData[historicalData.length - 1].close;
                    }
                    
                } catch (error) {
                    console.error(`Error updating ${pair.symbol}:`, error);
                    // Use demo data as fallback
                    const demoPrice = getDemoPrice(pair.symbol);
                    pair.price = demoPrice;
                    pair.change = (Math.random() - 0.5) * 0.001 * demoPrice;
                }
            }
            
            // Update UI
            populateMarketPairs();
            elements.lastUpdate.textContent = new Date().toLocaleTimeString();
            
            // If on trade tab, update signal
            if (document.querySelector('.tab-pane.active').id === 'tradeTab') {
                generateSignal();
            }
        }

        function generateAdvancedSignal() {
            if (!currentUser) {
                alert('Please login to generate signals');
                elements.loginModal.classList.remove('hidden');
                return;
            }
            
            const pair = currentPair;
            const strategy = currentStrategy;
            const strategyConfig = config.tradingStrategies[strategy];
            const indicators = technicalData[pair];
            
            // Get current price
            const pairData = marketPairs.find(p => p.symbol === pair);
            const currentPrice = pairData ? pairData.price : getDemoPrice(pair);
            
            const pipSize = config.pipValues[pair] || 0.0001;
            
            // Generate signal based on technical indicators
            let direction = "BUY";
            let signalStrength = "Medium";
            let tpMultiplier = strategyConfig.tpMultiplier;
            let slMultiplier = strategyConfig.slMultiplier;
            
            // Use technical analysis to determine direction
            if (indicators) {
                if (indicators.trend === "bullish" || indicators.trend === "oversold") {
                    direction = "BUY";
                    if (indicators.rsi < 30) signalStrength = "Very High";
                    else if (indicators.rsi < 40) signalStrength = "High";
                } else if (indicators.trend === "bearish" || indicators.trend === "overbought") {
                    direction = "SELL";
                    if (indicators.rsi > 70) signalStrength = "Very High";
                    else if (indicators.rsi > 60) signalStrength = "High";
                } else {
                    // Random direction for neutral markets
                    direction = Math.random() > 0.5 ? "BUY" : "SELL";
                    signalStrength = "Medium";
                }
                
                // Adjust TP/SL based on volatility and indicators
                const volatility = Math.abs(pairData?.change || 0.0005) * 10000;
                if (volatility > 20) {
                    tpMultiplier *= 1.5;
                    slMultiplier *= 1.2;
                } else if (volatility < 10) {
                    tpMultiplier *= 0.8;
                    slMultiplier *= 0.8;
                }
            }
            
            // Calculate TP/SL based on strategy
            let basePips;
            switch(strategy) {
                case "scalping":
                    basePips = 10 + Math.floor(Math.random() * 10);
                    break;
                case "day":
                    basePips = 30 + Math.floor(Math.random() * 20);
                    break;
                case "swing":
                    basePips = 50 + Math.floor(Math.random() * 30);
                    break;
                default:
                    basePips = 20;
            }
            
            const tpPips = Math.round(basePips * tpMultiplier);
            const slPips = Math.round(basePips * slMultiplier);
            
            // Calculate prices
            let entry, tp1, tp2, tp3, sl;
            
            if (direction === "BUY") {
                entry = currentPrice;
                tp1 = currentPrice + (tpPips * 0.5 * pipSize);
                tp2 = currentPrice + (tpPips * 0.8 * pipSize);
                tp3 = currentPrice + (tpPips * pipSize);
                sl = currentPrice - (slPips * pipSize);
            } else {
                entry = currentPrice;
                tp1 = currentPrice - (tpPips * 0.5 * pipSize);
                tp2 = currentPrice - (tpPips * 0.8 * pipSize);
                tp3 = currentPrice - (tpPips * pipSize);
                sl = currentPrice + (slPips * pipSize);
            }
            
            // Update display
            elements.tradeDirection.textContent = direction;
            elements.tradeDirection.className = `signal-direction ${direction.toLowerCase()}`;
            
            const decimalPlaces = pair === 'BTC/USD' ? 2 : (pair === 'XAU/USD' ? 2 : 5);
            elements.entryPrice.textContent = entry.toFixed(decimalPlaces);
            elements.stopLoss.textContent = sl.toFixed(decimalPlaces);
            elements.tp1.textContent = tp1.toFixed(decimalPlaces);
            elements.tp2.textContent = tp2.toFixed(decimalPlaces);
            elements.tp3.textContent = tp3.toFixed(decimalPlaces);
            elements.riskReward.textContent = strategyConfig.riskReward;
            elements.signalStrength.textContent = signalStrength;
            
            // Add to history
            const signal = {
                time: new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false }),
                date: new Date().toLocaleDateString('en-US', { month: 'short', day: '2-digit' }),
                pair: pair,
                direction: direction,
                entry: entry.toFixed(decimalPlaces),
                tp1: tp1.toFixed(decimalPlaces),
                tp2: tp2.toFixed(decimalPlaces),
                tp3: tp3.toFixed(decimalPlaces),
                sl: sl.toFixed(decimalPlaces),
                status: 'Active',
                strength: signalStrength
            };
            
            signalHistory.unshift(signal);
            if (signalHistory.length > 20) {
                signalHistory.length = 20;
            }
            
            // Update history if on history tab
            if (document.querySelector('.tab-pane.active').id === 'historyTab') {
                updateHistory();
            }
            
            // Update last update time
            elements.lastUpdate.textContent = new Date().toLocaleTimeString();
            elements.engineStatus.textContent = "Running";
            elements.engineStatus.style.color = "var(--primary-color)";
        }

        // Initialize
        function init() {
            setupEventListeners();
            updateMarketData(); // Initial market data load
            updateTime();
            setInterval(updateTime, 1000);
            updateSessionInfo();
            setInterval(updateSessionInfo, 60000);
            
            // Auto-refresh market data every 30 seconds
            setInterval(updateMarketData, 30000);
            
            // Check for saved login
            checkSavedLogin();
            
            // Initial chart update
            setTimeout(() => {
                updateChart();
                updateChartTab();
                generateAdvancedSignal();
            }, 2000);
        }

        function setupEventListeners() {
            // Menu Tabs
            elements.menuTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.dataset.tab;
                    switchTab(tabName);
                });
            });
            
            // Login/Register
            elements.loginBtn.addEventListener('click', handleLogin);
            elements.registerBtn.addEventListener('click', handleRegister);
            elements.showRegisterBtn.addEventListener('click', showRegisterForm);
            elements.showRegisterLink.addEventListener('click', showRegisterForm);
            elements.showLoginBtn.addEventListener('click', showLoginForm);
            elements.goToLoginBtn.addEventListener('click', showLoginForm);
            
            // Quotes Panel
            elements.refreshQuotes.addEventListener('click', () => {
                updateMarketData();
                alert('Refreshing real-time market data...');
            });
            
            // Trade Buttons
            elements.executeBuy.addEventListener('click', () => executeTrade('buy'));
            elements.executeSell.addEventListener('click', () => executeTrade('sell'));
            elements.refreshSignal.addEventListener('click', generateAdvancedSignal);
            
            // Strategy Options
            document.querySelectorAll('.strategy-option').forEach(option => {
                option.addEventListener('click', () => {
                    const strategy = option.dataset.strategy;
                    selectStrategy(strategy);
                });
            });
            
            // Logout
            elements.logoutBtn.addEventListener('click', handleLogout);
            
            // Chart Controls
            document.getElementById('zoomIn').addEventListener('click', () => alert('Zoom In'));
            document.getElementById('zoomOut').addEventListener('click', () => alert('Zoom Out'));
            document.getElementById('zoomIn2').addEventListener('click', () => alert('Zoom In'));
            document.getElementById('zoomOut2').addEventListener('click', () => alert('Zoom Out'));
            
            // Timeframe buttons in chart tab
            document.querySelectorAll('.chart-btn[data-tf]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const timeframe = e.target.dataset.tf;
                    updateChart(timeframe);
                });
            });
        }

        function switchTab(tabName) {
            // Update active tab
            elements.menuTabs.forEach(tab => {
                tab.classList.remove('active');
                if (tab.dataset.tab === tabName) {
                    tab.classList.add('active');
                }
            });
            
            // Show active tab content
            elements.tabPanes.forEach(pane => {
                pane.classList.remove('active');
                if (pane.id === tabName + 'Tab') {
                    pane.classList.add('active');
                    
                    // Load content for tab
                    switch(tabName) {
                        case 'quotes':
                            updateChart();
                            break;
                        case 'chart':
                            updateChartTab();
                            break;
                        case 'trade':
                            generateAdvancedSignal();
                            break;
                        case 'history':
                            updateHistory();
                            break;
                        case 'settings':
                            updateSettings();
                            break;
                    }
                }
            });
        }

        function populateMarketPairs() {
            elements.pairsList.innerHTML = '';
            
            if (marketPairs.every(p => p.price === 0)) {
                elements.pairsList.innerHTML = `
                    <div class="loading">
                        <i class="fas fa-spinner"></i> Loading market data...
                    </div>
                `;
                return;
            }
            
            marketPairs.forEach(pair => {
                const pairElement = document.createElement('div');
                pairElement.className = 'pair-item';
                if (pair.symbol === currentPair) pairElement.classList.add('active');
                pairElement.dataset.symbol = pair.symbol;
                
                const isPositive = pair.change >= 0;
                const price = pair.price || 0;
                const change = pair.change || 0;
                
                // Determine decimal places
                let decimalPlaces = 5;
                if (pair.symbol === 'BTC/USD' || pair.symbol === 'XAU/USD') {
                    decimalPlaces = 2;
                } else if (pair.symbol === 'USD/JPY') {
                    decimalPlaces = 3;
                }
                
                pairElement.innerHTML = `
                    <div>
                        <div class="pair-name">${pair.name}</div>
                        <div style="font-size: 11px; color: var(--light-color);">${pair.symbol}</div>
                    </div>
                    <div>
                        <div class="pair-price">${price.toFixed(decimalPlaces)}</div>
                        <div class="pair-change ${isPositive ? 'positive' : 'negative'}">
                            ${isPositive ? '+' : ''}${change.toFixed(decimalPlaces)}
                        </div>
                    </div>
                `;
                
                pairElement.addEventListener('click', () => {
                    selectPair(pair.symbol);
                });
                
                elements.pairsList.appendChild(pairElement);
            });
        }

        function selectPair(symbol) {
            currentPair = symbol;
            
            // Update active state
            document.querySelectorAll('.pair-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.symbol === symbol) {
                    item.classList.add('active');
                }
            });
            
            // Update trade display
            elements.tradePair.textContent = symbol;
            
            // Update charts
            updateChart();
            updateChartTab();
            
            // Generate new signal
            if (document.querySelector('.tab-pane.active').id === 'tradeTab') {
                generateAdvancedSignal();
            }
        }

        function selectStrategy(strategy) {
            currentStrategy = strategy;
            
            // Update active state
            document.querySelectorAll('.strategy-option').forEach(option => {
                option.classList.remove('active');
                if (option.dataset.strategy === strategy) {
                    option.classList.add('active');
                    option.querySelector('input').checked = true;
                }
            });
            
            // Update charts
            updateChart();
            updateChartTab();
            
            // Generate new signal with new strategy
            generateAdvancedSignal();
            
            // Save strategy preference
            if (currentUser) {
                currentUser.strategy = strategy;
                localStorage.setItem('userTradingStrategy', strategy);
            }
        }

        function updateChart(timeframe = null) {
            const strategy = currentStrategy;
            const tf = timeframe || config.tradingStrategies[strategy].timeframe;
            const symbol = currentPair.replace("/", "");
            
            const iframeSrc = `https://s.tradingview.com/widgetembed/?symbol=${symbol}&interval=${tf}&theme=dark&style=1&timezone=Africa%2FJohannesburg&hide_side_toolbar=true`;
            elements.mainChart.src = iframeSrc;
        }

        function updateChartTab() {
            const strategy = currentStrategy;
            const tf = config.tradingStrategies[strategy].timeframe;
            const symbol = currentPair.replace("/", "");
            
            const iframeSrc = `https://s.tradingview.com/widgetembed/?symbol=${symbol}&interval=${tf}&theme=dark&style=1&timezone=Africa%2FJohannesburg&hide_side_toolbar=true`;
            elements.chartTabFrame.src = iframeSrc;
        }

        function executeTrade(type) {
            if (!currentUser) {
                alert('Please login to trade');
                elements.loginModal.classList.remove('hidden');
                return;
            }
            
            alert(`${type.toUpperCase()} order executed for ${currentPair}!\nThank you for using FX BULLS PRO`);
            
            // Update signal status in history
            if (signalHistory.length > 0) {
                signalHistory[0].status = type.toUpperCase() + ' Executed';
                updateHistory();
            }
        }

        function updateHistory() {
            const tbody = elements.historyTableBody;
            tbody.innerHTML = '';
            
            if (signalHistory.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="9" style="text-align: center; padding: 40px; color: var(--light-color);">
                            No trading history yet. Generate your first signal!
                        </td>
                    </tr>
                `;
                return;
            }
            
            signalHistory.forEach(signal => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${signal.date} ${signal.time}</td>
                    <td>${signal.pair}</td>
                    <td class="${signal.direction === 'BUY' ? 'signal-buy' : 'signal-sell'}">${signal.direction}</td>
                    <td>${signal.entry}</td>
                    <td>${signal.tp1}</td>
                    <td>${signal.tp2}</td>
                    <td>${signal.tp3}</td>
                    <td>${signal.sl}</td>
                    <td style="color: ${signal.status === 'Active' ? 'var(--primary-color)' : 'var(--light-color)'}">${signal.status}</td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateSettings() {
            if (!currentUser) {
                // Clear settings if not logged in
                elements.accountDetails.innerHTML = `
                    <div class="info-row">
                        <span class="info-label">Status</span>
                        <span class="info-value" style="color: var(--danger-color);">Not Logged In</span>
                    </div>
                `;
                return;
            }
            
            // Update account details
            elements.accountDetails.innerHTML = `
                <div class="info-row">
                    <span class="info-label">Name</span>
                    <span class="info-value">${currentUser.name}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Email</span>
                    <span class="info-value">${currentUser.email}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">License Type</span>
                    <span class="info-value">PREMIUM</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Member Since</span>
                    <span class="info-value">${new Date(currentUser.registeredDate).toLocaleDateString()}</span>
                </div>
            `;
            
            // Update strategy selection
            selectStrategy(currentUser.strategy || 'day');
            
            // Update user status
            elements.userStatus.textContent = currentUser.name;
        }

        function updateSessionInfo() {
            const hour = new Date().getHours();
            let session = 'Market Closed';
            let statusColor = 'var(--danger-color)';
            
            if (hour >= 8 && hour < 17) {
                session = 'London Session';
                statusColor = 'var(--primary-color)';
            } else if (hour >= 13 && hour < 22) {
                session = 'New York Session';
                statusColor = 'var(--primary-color)';
            } else if (hour >= 22 || hour < 8) {
                session = 'Asian Session';
                statusColor = 'var(--primary-color)';
            }
            
            elements.currentSession.textContent = `Market: ${session}`;
            
            // Update session info in settings
            if (elements.sessionInfo) {
                elements.sessionInfo.innerHTML = `
                    <div class="session-item">
                        <span>Current Session:</span>
                        <span style="color: ${statusColor}; font-weight: bold;">${session}</span>
                    </div>
                    <div class="session-item">
                        <span>Status:</span>
                        <span style="color: ${statusColor}; font-weight: bold;">${statusColor === 'var(--primary-color)' ? 'Active' : 'Closed'}</span>
                    </div>
                    <div class="session-item">
                        <span>Best Time:</span>
                        <span style="color: var(--primary-color); font-weight: bold;">15:00-19:00 GMT</span>
                    </div>
                `;
            }
        }

        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            elements.currentTime.textContent = timeString;
        }

        function showLoginForm() {
            elements.registerForm.classList.add('hidden');
            elements.licenseDisplay.classList.add('hidden');
            elements.loginForm.classList.remove('hidden');
        }

        function showRegisterForm() {
            elements.loginForm.classList.add('hidden');
            elements.licenseDisplay.classList.add('hidden');
            elements.registerForm.classList.remove('hidden');
        }

        function handleLogin() {
            const email = elements.loginEmail.value.trim().toLowerCase();
            const password = elements.loginPassword.value;
            const licenseKey = elements.loginLicenseKey.value.trim();
            
            if (!email || !password || !licenseKey) {
                alert('Please fill in all fields');
                return;
            }
            
            const user = userDatabase[email];
            
            if (!user) {
                alert('User not found. Please register.');
                return;
            }
            
            if (user.password !== password) {
                alert('Incorrect password');
                return;
            }
            
            if (user.licenseKey !== licenseKey) {
                alert('Invalid license key');
                return;
            }
            
            // Login successful
            currentUser = user;
            localStorage.setItem('loggedIn', 'true');
            localStorage.setItem('userEmail', email);
            localStorage.setItem('userName', user.name);
            localStorage.setItem('userTradingStrategy', user.strategy);
            localStorage.setItem('licenseKey', licenseKey);
            
            // Update UI
            elements.connectionDot.className = 'status-dot connected';
            elements.connectionStatus.textContent = 'Connected';
            elements.userStatus.textContent = user.name;
            elements.loginModal.classList.add('hidden');
            
            // Update settings
            updateSettings();
            
            // Generate initial signal
            generateAdvancedSignal();
            
            // Switch to trade tab
            switchTab('trade');
        }

        function handleRegister() {
            const name = elements.regName.value.trim();
            const email = elements.regEmail.value.trim().toLowerCase();
            const password = elements.regPassword.value;
            const strategy = elements.tradingStrategy.value;
            const activationCode = elements.activationCode.value.trim();
            
            if (!name || !email || !password || !activationCode) {
                alert('Please fill in all fields');
                return;
            }
            
            if (userDatabase[email]) {
                alert('Email already registered');
                return;
            }
            
            if (!config.activationCodes.includes(activationCode)) {
                alert('Invalid activation code. Please contact 067 277 1746 for a valid code.');
                return;
            }
            
            // Generate license key
            const licenseKey = generateLicenseKey();
            
            // Create user
            userDatabase[email] = {
                name: name,
                email: email,
                password: password,
                licenseKey: licenseKey,
                strategy: strategy,
                registeredDate: new Date().toISOString()
            };
            
            // Show license key
            elements.generatedLicenseKey.textContent = licenseKey;
            elements.registerForm.classList.add('hidden');
            elements.licenseDisplay.classList.remove('hidden');
            
            // Save email
            localStorage.setItem('userEmail', email);
        }

        function generateLicenseKey() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let key = '';
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    key += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                if (i < 3) key += '-';
            }
            return key;
        }

        function checkSavedLogin() {
            const loggedIn = localStorage.getItem('loggedIn') === 'true';
            const userEmail = localStorage.getItem('userEmail');
            
            if (loggedIn && userEmail && userDatabase[userEmail]) {
                currentUser = userDatabase[userEmail];
                elements.connectionDot.className = 'status-dot connected';
                elements.connectionStatus.textContent = 'Connected';
                elements.userStatus.textContent = currentUser.name;
                elements.loginModal.classList.add('hidden');
                updateSettings();
                generateAdvancedSignal();
            }
        }

        function handleLogout() {
            currentUser = null;
            localStorage.removeItem('loggedIn');
            elements.connectionDot.className = 'status-dot disconnected';
            elements.connectionStatus.textContent = 'Disconnected';
            elements.userStatus.textContent = 'Not logged in';
            elements.loginModal.classList.remove('hidden');
            showLoginForm();
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
